import{a as P}from"./chunk-74MJURPX.js";import{a as G,b as U}from"./chunk-DNH6BBZV.js";import{a as j}from"./chunk-QB2EKRTE.js";import{a as B,b as D}from"./chunk-UQEQSQWP.js";import{a as E,b as M,c as F,d as T,f as I,i as V,j as N,m as R,o as z}from"./chunk-RWD2KIVF.js";import{d as S,j as y,q as k}from"./chunk-NIGWU2LA.js";import{Ga as O,Ma as f,Ua as m,Va as C,Wa as L,Xa as r,Ya as n,Za as v,_a as b,aa as p,ba as _,bb as u,cb as d,ga as h,gb as a,ua as w,wa as c,xa as x}from"./chunk-SSAAJQVM.js";function Y(e,s){e&1&&(r(0,"div",20)(1,"h1",2),a(2,"Non sei registrato, per favore registrati"),n()())}function H(e,s){e&1&&(r(0,"div",21),a(1," L'email non \xE8 valida. "),n())}function q(e,s){e&1&&(r(0,"div",21),a(1," La password deve contenere almeno una lettera maiuscola, un numero e avere tra 5 e 10 caratteri. "),n())}function A(e,s){if(e&1){let t=b();r(0,"button",22),u("click",function(){p(t);let l=d(2);return _(l.onLogin())}),a(1," Log In "),n()}if(e&2){let t=d(2);m("disabled",t.loginForm.invalid)}}function J(e,s){if(e&1){let t=b();r(0,"button",23),u("click",function(){p(t);let l=d(2);return _(l.onRegister())}),a(1," Registrati "),n()}if(e&2){let t=d(2);m("disabled",t.loginForm.invalid)}}function K(e,s){if(e&1){let t=b();r(0,"div",0)(1,"div",3)(2,"div",4),v(3,"img",5),n(),f(4,Y,3,0,"div",6),n(),r(5,"div",7)(6,"div",8)(7,"button",9),u("click",function(){p(t);let l=d();return _(l.switchToLogin())}),a(8,"Log In"),n(),r(9,"button",9),u("click",function(){p(t);let l=d();return _(l.switchToRegister())}),a(10,"Registrati"),n()(),r(11,"form",10)(12,"div",11),v(13,"input",12),f(14,H,2,0,"div",13),n(),r(15,"p"),a(16," Continuando, accetti le "),r(17,"a",14),a(18,"condizioni d'uso"),n(),a(19," di Nike e confermi di aver letto l'"),r(20,"a",15),a(21,"informativa sulla privacy"),n(),a(22," di Nike. "),n(),r(23,"div",11),v(24,"input",16),f(25,q,2,0,"div",13),n(),r(26,"div",17),f(27,A,2,1,"button",18)(28,J,2,1,"button",19),n()()()()}if(e&2){let t,o,l,g,i=d();c(4),m("ngIf",i.showError),c(3),C("active",i.isLoginMode),c(2),C("active",!i.isLoginMode),c(2),m("formGroup",i.loginForm),c(2),C("invalid",((t=i.loginForm.get("email"))==null?null:t.invalid)&&((t=i.loginForm.get("email"))==null?null:t.touched)),c(),m("ngIf",((o=i.loginForm.get("email"))==null?null:o.invalid)&&((o=i.loginForm.get("email"))==null?null:o.touched)),c(10),C("invalid",((l=i.loginForm.get("password"))==null?null:l.invalid)&&((l=i.loginForm.get("password"))==null?null:l.touched)),c(),m("ngIf",((g=i.loginForm.get("password"))==null?null:g.invalid)&&((g=i.loginForm.get("password"))==null?null:g.touched)),c(2),m("ngIf",i.isLoginMode),c(),m("ngIf",!i.isLoginMode)}}function Q(e,s){e&1&&(r(0,"div",21),a(1," L'email non \xE8 valida. "),n())}function X(e,s){e&1&&(r(0,"div",21),a(1," La password deve contenere almeno una lettera maiuscola, un numero e avere tra 5 e 10 caratteri. "),n())}function Z(e,s){if(e&1){let t=b();r(0,"button",22),u("click",function(){p(t);let l=d(2);return _(l.onLogin())}),a(1," Log In "),n()}if(e&2){let t=d(2);m("disabled",t.loginForm.invalid)}}function $(e,s){if(e&1){let t=b();r(0,"button",23),u("click",function(){p(t);let l=d(2);return _(l.onRegister())}),a(1," Registrati "),n()}if(e&2){let t=d(2);m("disabled",t.loginForm.invalid)}}function tt(e,s){if(e&1){let t=b();r(0,"div",1)(1,"div",4),v(2,"img",5),n(),r(3,"div",7)(4,"div",8)(5,"button",9),u("click",function(){p(t);let l=d();return _(l.switchToLogin())}),a(6,"Log In"),n(),r(7,"button",9),u("click",function(){p(t);let l=d();return _(l.switchToRegister())}),a(8,"Registrati"),n()(),r(9,"form",10)(10,"div",11),v(11,"input",12),f(12,Q,2,0,"div",13),n(),r(13,"p"),a(14," Continuando, accetti le "),r(15,"a",14),a(16,"condizioni d'uso"),n(),a(17," di Nike e confermi di aver letto l'"),r(18,"a",15),a(19,"informativa sulla privacy"),n(),a(20," di Nike. "),n(),r(21,"div",11),v(22,"input",16),f(23,X,2,0,"div",13),n(),r(24,"div",17),f(25,Z,2,1,"button",18)(26,$,2,1,"button",19),n()()()()}if(e&2){let t,o,l,g,i=d();c(5),C("active",i.isLoginMode),c(2),C("active",!i.isLoginMode),c(2),m("formGroup",i.loginForm),c(2),C("invalid",((t=i.loginForm.get("email"))==null?null:t.invalid)&&((t=i.loginForm.get("email"))==null?null:t.touched)),c(),m("ngIf",((o=i.loginForm.get("email"))==null?null:o.invalid)&&((o=i.loginForm.get("email"))==null?null:o.touched)),c(10),C("invalid",((l=i.loginForm.get("password"))==null?null:l.invalid)&&((l=i.loginForm.get("password"))==null?null:l.touched)),c(),m("ngIf",((g=i.loginForm.get("password"))==null?null:g.invalid)&&((g=i.loginForm.get("password"))==null?null:g.touched)),c(2),m("ngIf",i.isLoginMode),c(),m("ngIf",!i.isLoginMode)}}var W=class e{constructor(s,t,o,l,g){this.usersService=s;this.Formbuilder=t;this.productsService=o;this.router=l;this.cartService=g;this.loginForm=this.Formbuilder.group({email:["",[M.required,P.validateEmail]],password:["",[M.required,P.validatePassword]]})}showError=!1;loginError=!1;loginForm;isLoginMode=!0;loginStatusChange=new h;Desktop=!0;onResize(){this.checkBodyWidth()}checkBodyWidth(){let s=document.body.clientWidth;this.Desktop=s>810}switchToLogin(){this.isLoginMode=!0}switchToRegister(){this.isLoginMode=!1}onLogin(){let s=this.loginForm.get("email")?.value,t=this.loginForm.get("password")?.value;this.usersService.loginUser(s,t).subscribe({next:o=>{this.usersService.setLoggedStatus(!0),this.usersService.setUserId(o.user.id),this.cartService.syncLocalCartWithServer(),this.router.navigate([""])},error:o=>{console.error("Login fallito:",o),this.isLoginMode=!1,this.showError=!0,setTimeout(()=>this.showError=!1,3e3)}})}onRegister(){if(this.loginForm.valid){let s=this.loginForm.get("email")?.value,t=this.loginForm.get("password")?.value;this.usersService.registerUser(s,t).subscribe({next:()=>{this.switchToLogin()},error:o=>{console.error("Errore durante la registrazione:",o)}})}}static \u0275fac=function(t){return new(t||e)(x(B),x(R),x(j),x(k),x(D))};static \u0275cmp=O({type:e,selectors:[["app-login"]],hostBindings:function(t,o){t&1&&u("resize",function(g){return o.onResize(g)},!1,w)},outputs:{loginStatusChange:"loginStatusChange"},decls:4,vars:1,consts:[["id","login",1,"d-flex","align-items-center","justify-content-center","w-100"],["id","login",1,"d-flex","flex-column","align-items-center","justify-content-center","w-100","p-3",2,"display","none"],[1,""],[1,"logo-container"],["id","",1,"m-5","login_img"],["src","img/logo/logo.png","alt",""],["class","error p-3 position-absolute ",4,"ngIf"],[1,"login-form"],[1,"toggle-buttons"],[3,"click"],[3,"formGroup"],[1,"form-group"],["type","email","placeholder","E-mail*","formControlName","email"],["class","error-message",4,"ngIf"],["id","","href","/404",1,""],["href","/404"],["type","password","placeholder","Password*","formControlName","password"],[1,"button-group"],["type","button","class","submit-button",3,"disabled","click",4,"ngIf"],["type","button","class","register-button",3,"disabled","click",4,"ngIf"],[1,"error","p-3","position-absolute"],[1,"error-message"],["type","button",1,"submit-button",3,"click","disabled"],["type","button",1,"register-button",3,"click","disabled"]],template:function(t,o){t&1&&(v(0,"app-nav"),f(1,K,29,14,"div",0)(2,tt,27,13,"div",1),v(3,"app-footer",2)),t&2&&(c(),L(o.Desktop?1:2))},dependencies:[z,I,E,F,T,V,N,y,S,G,U],styles:["[_nghost-%COMP%]{display:block;min-height:100vh}#login[_ngcontent-%COMP%]{height:88vh}.login-form[_ngcontent-%COMP%]{max-width:400px;margin:auto;text-align:center}.login-form[_ngcontent-%COMP%]   .toggle-buttons[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-bottom:1.5rem}.login-form[_ngcontent-%COMP%]   .toggle-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;padding:.8rem;background-color:#fafafa;border:1px solid #0077C0;font-size:1.2rem;cursor:pointer;transition:background-color .3s;color:#0077c0}.login-form[_ngcontent-%COMP%]   .toggle-buttons[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background-color:#0077c0;color:#fafafa}.login-form[_ngcontent-%COMP%]   .toggle-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#c7eeff;color:#1d242b}.login-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:1.5rem}.login-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:.8rem;border:1px solid #0077C0;border-radius:5px;font-size:1rem;outline:none}.login-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:#1d242b}.login-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input.invalid[_ngcontent-%COMP%]{border-color:#e60000}.login-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{color:#e60000;font-size:.9rem;margin-top:.5rem}.login-form[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.9rem;color:#fafafa;margin-bottom:1.5rem}.login-form[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fafafa;text-decoration:underline}.login-form[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .submit-button[_ngcontent-%COMP%], .login-form[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .register-button[_ngcontent-%COMP%]{width:100%;padding:1rem;font-size:1.2rem;border-radius:5px;cursor:pointer;border:1px solid #0077C0;background-color:#0077c0;color:#fafafa;transition:background-color .3s}.login-form[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .submit-button[_ngcontent-%COMP%]:hover, .login-form[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .register-button[_ngcontent-%COMP%]:hover{background-color:#1d242b;color:#fafafa}.login-form[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .submit-button[_ngcontent-%COMP%]:disabled, .login-form[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .register-button[_ngcontent-%COMP%]:disabled{background-color:#0077c0;color:#000000a4;cursor:not-allowed}.logo-container[_ngcontent-%COMP%]{margin:auto}.login_img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:20rem}.error[_ngcontent-%COMP%]{background-color:#ff00001a;color:red;border:1px solid red;padding:10px;text-align:center;opacity:0;transform:translateY(-10px);animation:_ngcontent-%COMP%_fadeIn .5s forwards,_ngcontent-%COMP%_fadeOut .5s 2.5s forwards}.error[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.5em}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_fadeOut{0%{opacity:1;transform:translateY(0)}to{opacity:0;transform:translateY(-10px)}}"]})};export{W as LoginComponent};
