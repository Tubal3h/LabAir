import{a as K}from"./chunk-M6WNSHEN.js";import{a as G,b as J}from"./chunk-VAXYI5TX.js";import{a as W}from"./chunk-CQE7WRDC.js";import{a as H,b as q}from"./chunk-6N6B5WLE.js";import"./chunk-LHJOZ67R.js";import{b as T,c as B,d as D,e as U,g as R,h as j,j as L,o as A,r as $,t as N}from"./chunk-NIGWU2LA.js";import{Ga as E,Ma as _,Ta as z,Ua as d,Va as w,Wa as V,Xa as o,Ya as r,Za as f,_a as v,aa as u,ba as m,bb as p,cb as s,db as M,fb as I,gb as l,hb as O,ib as C,ob as x,qb as P,rb as F,sa as b,sb as S,ua as y,ub as k,wa as a,xa as h}from"./chunk-SSAAJQVM.js";var Q=n=>({"border-danger":n}),Y=n=>({background:n}),Z=n=>({"favorite-active":n});function ee(n,i){if(n&1){let e=v();o(0,"img",27),p("click",function(){let c=u(e).$implicit,g=s();return m(g.selectImage(c))}),r()}if(n&2){let e=i.$implicit,t=s();w("selected",t.selectedImage===e),d("src",e,b)}}function te(n,i){if(n&1){let e=v();o(0,"button",28),P(1,"titlecase"),p("click",function(){let c=u(e).$implicit,g=s();return m(g.selectColor(c))}),r()}if(n&2){let e=i.$implicit,t=s();w("selected",t.selectedColor===e),d("ngStyle",x(6,Y,t.generateBackground(e))),z("title",F(1,4,e))}}function ne(n,i){n&1&&(o(0,"p",29),l(1,"Per favore, seleziona un colore."),r())}function ie(n,i){if(n&1){let e=v();o(0,"button",30),p("click",function(){let c=u(e).$implicit,g=s();return m(g.selectSize(c))}),l(1),r()}if(n&2){let e=i.$implicit,t=s();w("selected",t.selectedSize===e),d("disabled",!e),a(),C(" ",e," ")}}function oe(n,i){n&1&&(o(0,"p",29),l(1,"Per favore, seleziona una taglia."),r())}function re(n,i){if(n&1){let e=v();o(0,"button",31),p("click",function(){u(e);let c=s();return m(c.toggleFavorite())}),l(1),r()}if(n&2){let e=s();d("ngClass",x(2,Z,e.isFavorite)),a(),C(" ",e.isFavorite?"\u2764\uFE0F Aggiunto ai preferiti":"\u{1F90D} Aggiungi ai preferiti"," ")}}function ce(n,i){if(n&1&&(o(0,"div",40)(1,"div",41),f(2,"img",42),r(),o(3,"div",43)(4,"div",44),l(5),r(),o(6,"div",45),l(7),P(8,"currency"),r()()()),n&2){let e=s(3);a(2),M("src",e.product.image[0],b),a(3),C(" ",e.product.name," "),a(2),C(" ",S(8,3,e.product.price,"EUR")," ")}}function ae(n,i){if(n&1){let e=v();o(0,"div",33)(1,"div",34),_(2,ce,9,6,"div",35),o(3,"div",36)(4,"button",37),p("click",function(){u(e);let c=s(2);return m(c.previewBannerOff())}),l(5,"Vai al carrello"),r(),o(6,"button",38),p("click",function(){u(e);let c=s(2);return m(c.previewBannerOff())}),l(7,"Pagamento"),r(),o(8,"button",39),p("click",function(){u(e);let c=s(2);return m(c.previewBannerOff())}),l(9,"Continua Shopping"),r()()()()}if(n&2){let e=s(2);a(2),d("ngIf",e.product)}}function le(n,i){if(n&1&&(o(0,"div",40)(1,"div",41),f(2,"img",42),r(),o(3,"div",43)(4,"div",44),l(5),r(),o(6,"div",45),l(7),P(8,"currency"),r()()()),n&2){let e=s(3);a(2),M("src",e.product.image[0],b),a(3),C(" ",e.product.name," "),a(2),C(" ",S(8,3,e.product.price,"EUR")," ")}}function se(n,i){if(n&1){let e=v();o(0,"div",46)(1,"div",47),_(2,le,9,6,"div",35),o(3,"div",36)(4,"button",37),p("click",function(){u(e);let c=s(2);return m(c.previewBannerOff())}),l(5,"Vai al carrello"),r(),o(6,"button",38),p("click",function(){u(e);let c=s(2);return m(c.previewBannerOff())}),l(7,"Pagamento"),r(),o(8,"button",39),p("click",function(){u(e);let c=s(2);return m(c.previewBannerOff())}),l(9,"Continua Shopping"),r()()()()}if(n&2){let e=s(2);a(2),d("ngIf",e.product)}}function de(n,i){if(n&1&&_(0,ae,10,1,"div",32)(1,se,10,1,"ng-template",null,1,k),n&2){let e=I(2),t=s();d("ngIf",t.Desktop)("ngIfElse",e)}}function pe(n,i){n&1&&f(0,"app-footer",48)}function ue(n,i){n&1&&f(0,"app-footer")}var X=class n{constructor(i,e,t,c,g){this.route=i;this.productService=e;this.cartService=t;this.usersService=c;this.accountService=g}product=null;selectedImage=null;currentIndex=0;selectedColor=null;selectedSize=null;availableColors=[];previewBanner=!1;showColorError=!1;showSizeError=!1;Desktop=!0;isLogged=!1;isFavorite=!1;onResize(){this.checkBodyWidth()}checkBodyWidth(){let i=document.body.clientWidth;this.Desktop=i>810}ngOnInit(){this.checkBodyWidth(),console.log(this.Desktop);let i=this.route.snapshot.params.id;this.productService.getProductById(i).subscribe(e=>{this.product=e,this.availableColors=this.product?.color_available||[],this.selectedImage=this.product?.image?.[0]||null,this.usersService.isLogged$.subscribe(t=>{this.isLogged=t,this.isLogged&&this.product&&this.checkIfFavorite()})})}checkIfFavorite(){let i=this.usersService.getUserId();!i||!this.product||this.accountService.getFavorites().subscribe(e=>{this.isFavorite=e.some(t=>t.id_product===this.product?.id&&t.userID===i)})}toggleFavorite(){if(this.showColorError=!this.selectedColor,this.showSizeError=!this.selectedSize,!this.selectedColor||!this.selectedSize||!this.product||!this.isLogged||!this.product)return;let i=this.usersService.getUserId();if(i)if(this.isFavorite)this.accountService.removeFavorite(this.product.id).subscribe(()=>{this.isFavorite=!1});else{let e={userID:i,id_product:this.product.id,size:this.selectedSize,img:this.product.image[0],name:this.product.name,price:this.product.price,color:this.selectedColor,category:this.product.category};this.accountService.addFavorite(e).subscribe(()=>{this.isFavorite=!0})}}selectColor(i){this.selectedColor=i,this.showColorError=!1}selectSize(i){this.selectedSize=i,this.showSizeError=!1}generateBackground(i){let e=i.split("/").map(t=>t.trim());return e.length>1?`linear-gradient(45deg, ${e.join(", ")})`:e[0]}navigateImage(i){if(!this.product?.image||this.product.image.length===0)return;let e=this.product.image.length;this.currentIndex=i==="prev"?(this.currentIndex-1+e)%e:(this.currentIndex+1)%e,this.selectedImage=this.product.image[this.currentIndex]}selectImage(i){this.product?.image?.includes(i)&&(this.selectedImage=i)}addToCart(){if(this.showColorError=!this.selectedColor,this.showSizeError=!this.selectedSize,!this.selectedColor||!this.selectedSize||!this.product)return;let i=this.usersService.getUserId(),e={userID:i,id_product:this.product.id,quantity:1,size:parseInt(this.selectedSize),img:this.product.image[0],name:this.product.name,price:this.product.price,color:this.selectedColor,category:this.product.category};i?this.cartService.addToCart(e):this.cartService.addToCart(e),this.previewBannerOn()}previewBannerOn(){this.previewBanner=!0}previewBannerOff(){this.previewBanner=!1}static \u0275fac=function(e){return new(e||n)(h(A),h(W),h(q),h(H),h(K))};static \u0275cmp=E({type:n,selectors:[["app-product"]],hostBindings:function(e,t){e&1&&p("resize",function(g){return t.onResize(g)},!1,y)},decls:38,vars:22,consts:[["Mobile",""],["mobile",""],[1,"container","my-5"],[1,"row","product-container"],[1,"col-md-6","image-section"],["id","imageCarousel",1,"carousel","slide","d-flex","flex-column"],[1,"carousel-inner"],["alt","Immagine Prodotto",1,"w-100","rounded","main-image",3,"src"],["type","button",1,"carousel-control-prev",3,"click"],["aria-hidden","true",1,"carousel-control-prev-icon"],["type","button",1,"carousel-control-next",3,"click"],["aria-hidden","true",1,"carousel-control-next-icon"],[1,"d-flex","mt-3","justify-content-center","gap-2"],["class","thumbnail",3,"src","selected","click",4,"ngFor","ngForOf"],[1,"col-md-6","product-details"],[1,"fw-bold"],[1,"text-muted"],[1,"price","fs-4"],[1,"mt-4"],[1,"d-flex","flex-wrap","gap-2","product-colors",3,"ngClass"],["class","color-rectangle",3,"selected","ngStyle","click",4,"ngFor","ngForOf"],["class","text-danger mt-2",4,"ngIf"],[1,"size-options",3,"ngClass"],["class","btn btn-outline-secondary mb-2",3,"selected","disabled","click",4,"ngFor","ngForOf"],[1,"btn","btn-dark","w-100","mt-4","add-to-cart-button",3,"click"],["class","btn btn-dark w-100 mt-4 add-to-favorites",3,"ngClass","click",4,"ngIf"],["class","position-absolute bottom-0",4,"ngIf","ngIfElse"],[1,"thumbnail",3,"click","src"],[1,"color-rectangle",3,"click","ngStyle"],[1,"text-danger","mt-2"],[1,"btn","btn-outline-secondary","mb-2",3,"click","disabled"],[1,"btn","btn-dark","w-100","mt-4","add-to-favorites",3,"click","ngClass"],["id","","class","preview-container position-absolute top-0 start-0  w-100 vh-100 ",4,"ngIf","ngIfElse"],["id","",1,"preview-container","position-absolute","top-0","start-0","w-100","vh-100"],["id","",1,"preview-banner","position-absolute","top-0","end-0","p-5"],["id","","class","item-details d-flex",4,"ngIf"],["id","",1,""],["id","","routerLink","/cart",1,"btn","btn-dark","w-100","mt-4","add-to-cart-button",3,"click"],["id","","routerLink","/checkout",1,"btn","btn-outline-secondary","w-100","mt-2","add-to-favorites",3,"click"],["id","",1,"btn","btn-outline-secondary","w-100","mt-2","add-to-favorites",3,"click"],["id","",1,"item-details","d-flex"],["id","",1,"img-container","rounded-circle","overflow-hidden","m-3"],["alt","",3,"src"],["id","",1,"item-details","d-flex","justify-content-center","align-items-center","flex-column"],["id","",1,"item-name"],["id","",1,"item-price"],["id","",1,"preview-container","position-fixed","top-0","w-100"],["id","",1,"preview-banner","position-absofixedlute","bottom-0","w-100","my-5"],[1,"position-absolute","bottom-0"]],template:function(e,t){if(e&1){let c=v();f(0,"app-nav"),o(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5)(5,"div",6),f(6,"img",7),r(),o(7,"button",8),p("click",function(){return u(c),m(t.navigateImage("prev"))}),f(8,"span",9),r(),o(9,"button",10),p("click",function(){return u(c),m(t.navigateImage("next"))}),f(10,"span",11),r()(),o(11,"div",12),_(12,ee,1,3,"img",13),r()(),o(13,"div",14)(14,"h1",15),l(15),r(),o(16,"p",16),l(17),r(),o(18,"p",17),l(19),P(20,"currency"),r(),o(21,"h4",18),l(22,"Seleziona un colore:"),r(),o(23,"div",19),_(24,te,2,8,"button",20),r(),_(25,ne,2,0,"p",21),o(26,"h4",18),l(27,"Seleziona la taglia/misura"),r(),o(28,"div",22),_(29,ie,2,4,"button",23),r(),_(30,oe,2,0,"p",21),o(31,"button",24),p("click",function(){return u(c),m(t.addToCart())}),l(32,"Aggiungi al carrello"),r(),_(33,re,2,4,"button",25),r()()(),_(34,de,3,2)(35,pe,1,0,"app-footer",26)(36,ue,1,0,"ng-template",null,0,k)}if(e&2){let c=I(37);a(6),d("src",t.selectedImage,b),a(6),d("ngForOf",t.product==null?null:t.product.image),a(3),O(t.product==null?null:t.product.name),a(2),O(t.product==null?null:t.product.category),a(2),O(S(20,15,t.product==null?null:t.product.price,"EUR")),a(4),d("ngClass",x(18,Q,t.showColorError)),a(),d("ngForOf",t.product==null?null:t.product.color_available),a(),d("ngIf",t.showColorError),a(3),d("ngClass",x(20,Q,t.showSizeError)),a(),d("ngForOf",t.product==null?null:t.product.size_available),a(),d("ngIf",t.showSizeError),a(3),d("ngIf",t.isLogged),a(),V(t.previewBanner?34:-1),a(),d("ngIf",t.Desktop)("ngIfElse",c)}},dependencies:[L,T,B,D,U,R,j,G,J,N,$],styles:["[_nghost-%COMP%]{display:block;min-height:100vh}.product-container[_ngcontent-%COMP%]{background-color:#fafafa;border:3px solid #0077c0;border-radius:12px;padding:20px}.product-container[_ngcontent-%COMP%]   .image-section[_ngcontent-%COMP%]   .carousel[_ngcontent-%COMP%]   .main-image[_ngcontent-%COMP%]{max-height:450px;border-radius:12px;object-fit:cover}.product-container[_ngcontent-%COMP%]   .image-section[_ngcontent-%COMP%]   .carousel[_ngcontent-%COMP%]   .carousel-control-prev[_ngcontent-%COMP%], .product-container[_ngcontent-%COMP%]   .image-section[_ngcontent-%COMP%]   .carousel[_ngcontent-%COMP%]   .carousel-control-next[_ngcontent-%COMP%]{filter:invert(100%)}.product-container[_ngcontent-%COMP%]   .image-section[_ngcontent-%COMP%]   .thumbnail[_ngcontent-%COMP%]{width:70px;height:70px;object-fit:cover;border-radius:8px;cursor:pointer;border:2px solid transparent}.product-container[_ngcontent-%COMP%]   .image-section[_ngcontent-%COMP%]   .thumbnail[_ngcontent-%COMP%]:hover{border-color:#fafafa}.product-container[_ngcontent-%COMP%]   .image-section[_ngcontent-%COMP%]   .thumbnail.selected[_ngcontent-%COMP%]{border-color:#0077c0}.product-container[_ngcontent-%COMP%]   .product-details[_ngcontent-%COMP%]   .price[_ngcontent-%COMP%]{font-size:24px;font-weight:700}.product-container[_ngcontent-%COMP%]   .product-details[_ngcontent-%COMP%]   .product-colors[_ngcontent-%COMP%]   .color-rectangle[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:4px;border:2px solid #1D242B;cursor:pointer;transition:transform .2s ease}.product-container[_ngcontent-%COMP%]   .product-details[_ngcontent-%COMP%]   .product-colors[_ngcontent-%COMP%]   .color-rectangle.selected[_ngcontent-%COMP%]{border-color:#0077c0;transform:scale(1.1)}.product-container[_ngcontent-%COMP%]   .product-details[_ngcontent-%COMP%]   .product-colors[_ngcontent-%COMP%]   .color-rectangle[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.product-container[_ngcontent-%COMP%]   .product-details[_ngcontent-%COMP%]   .size-options[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(4,1fr);gap:10px}.product-container[_ngcontent-%COMP%]   .product-details[_ngcontent-%COMP%]   .size-options[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:10px;font-size:14px}.product-container[_ngcontent-%COMP%]   .product-details[_ngcontent-%COMP%]   .size-options[_ngcontent-%COMP%]   button.selected[_ngcontent-%COMP%]{background-color:#0077c0;color:#fafafa}.product-container[_ngcontent-%COMP%]   .product-details[_ngcontent-%COMP%]   .size-options[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{cursor:not-allowed;background-color:#fafafa}.product-container[_ngcontent-%COMP%]   .product-details[_ngcontent-%COMP%]   .add-to-cart-button[_ngcontent-%COMP%], .product-container[_ngcontent-%COMP%]   .product-details[_ngcontent-%COMP%]   .add-to-favorites[_ngcontent-%COMP%]{border-radius:4px;font-weight:700}.product-container[_ngcontent-%COMP%]   .product-details[_ngcontent-%COMP%]   .border-danger[_ngcontent-%COMP%]{border:2px solid red;border-radius:5px;padding:10px}.preview-container[_ngcontent-%COMP%]{background-color:#00000093;z-index:999}.preview-container[_ngcontent-%COMP%]   .preview-banner[_ngcontent-%COMP%]{background-color:#fff;min-width:25%;min-height:25%;border-bottom-left-radius:30px}.preview-container[_ngcontent-%COMP%]   .img-container[_ngcontent-%COMP%]{border:2px solid black}.preview-container[_ngcontent-%COMP%]   .img-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:10rem;height:10rem}button.favorite-active[_ngcontent-%COMP%]{background-color:#0077c0;color:#fff}@media (max-width: 810px){.preview-container[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100vh;background:#00000080;display:flex;justify-content:center;align-items:center;z-index:1050}.preview-container[_ngcontent-%COMP%]   .preview-banner[_ngcontent-%COMP%]{background:#fff;padding:20px;border-radius:10px;box-shadow:0 5px 15px #0003;max-width:500px;width:90%;text-align:center}}@media (max-width: 810px) and (max-width: 768px){.preview-container[_ngcontent-%COMP%]{align-items:flex-end}.preview-banner[_ngcontent-%COMP%]{width:100%;border-radius:15px 15px 0 0}}"]})};export{X as ProductComponent};
